<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>T√°c V·ª• Chung - LSPD</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: Arial, sans-serif;
    }
    .content-box {
      background: rgba(255,255,255,0.95);
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      max-width: 1100px;
      margin: 30px auto;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
      font-weight: bold;
    }
    .task-btn {
      margin: 10px;
      padding: 15px;
      font-weight: bold;
      font-size: 16px;
      border-radius: 8px;
      width: 250px;
    }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="dashboard.html">LSSD</a>
    <div class="collapse navbar-collapse">
      <ul class="navbar-nav me-auto">
        <li class="nav-item"><a class="nav-link" href="dashboard.html">Trang Ch·ªß</a></li>
        <li class="nav-item"><a class="nav-link" href="duty.html">Ch·∫•m C√¥ng</a></li>
        <li class="nav-item"><a class="nav-link" href="bail.html">B·∫£o L√£nh T·ªôi Ph·∫°m</a></li>
        <li class="nav-item"><a class="nav-link" href="support.html">H·ªó Tr·ª£ X·ª≠ √Ån</a></li>
        <li class="nav-item"><a class="nav-link" href="wanted.html">H·ªó Tr·ª£ Truy N√£</a></li>
        <li class="nav-item"><a class="nav-link" href="leave.html">ƒê∆°n Xin Ngh·ªâ Ph√©p</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle active" href="#" role="button" data-bs-toggle="dropdown">Qu·∫£n L√Ω</a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="manage.html">üëÆ Nh√¢n S·ª±</a></li>
            <li><a class="dropdown-item" href="salary.html">üí∞ H·ªá S·ªë L∆∞∆°ng</a></li>
            <li><a class="dropdown-item" href="timekeeping.html">üïí C√¥ng/L∆∞∆°ng</a></li>
            <li><a class="dropdown-item active" href="tasks.html">‚öôÔ∏è T√°c V·ª• Chung</a></li>
          </ul>
        </li>
      </ul>
      <a href="#" id="btnLogout" class="btn btn-outline-warning btn-sm">ƒêƒÉng xu·∫•t</a>
    </div>
  </div>
</nav>

<div class="container">
  <div class="content-box">
    <h2>‚öôÔ∏è T√°c V·ª• Chung</h2>
    <div class="d-flex flex-wrap justify-content-center">
      <button class="btn btn-primary task-btn" onclick="exportAll()">üì• Xu·∫•t To√†n B·ªô D·ªØ Li·ªáu</button>
      <button class="btn btn-danger task-btn" onclick="clearData()">üóë X√≥a D·ªØ Li·ªáu T·∫°m</button>
      <button class="btn btn-warning task-btn" onclick="resetSystem()">‚ôªÔ∏è Reset H·ªá Th·ªëng</button>
      <button class="btn btn-success task-btn" onclick="generateReport()">üìä B√°o C√°o T·ªïng H·ª£p</button>
      <button class="btn btn-info task-btn" onclick="manageUsers()">üë§ Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</button>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
/* ‚úÖ Xu·∫•t to√†n b·ªô d·ªØ li·ªáu trong localStorage ra Excel */
function exportAll(){
  let allData = {};
  for(let i=0; i<localStorage.length; i++){
    let key = localStorage.key(i);
    try {
      allData[key] = JSON.parse(localStorage.getItem(key));
    } catch {
      allData[key] = localStorage.getItem(key);
    }
  }
  const ws = XLSX.utils.json_to_sheet(Object.entries(allData).map(([k,v])=>({Key:k,Value:JSON.stringify(v)})));
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "AllData");
  XLSX.writeFile(wb, "LSSD_AllData.xlsx");
  alert("‚úÖ ƒê√£ xu·∫•t to√†n b·ªô d·ªØ li·ªáu!");
}

/* ‚úÖ X√≥a d·ªØ li·ªáu t·∫°m */
function clearData(){
  if(confirm("‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô d·ªØ li·ªáu t·∫°m (kh√¥ng ·∫£nh h∆∞·ªüng nh√¢n s·ª±)?")){
    localStorage.removeItem("lspd_trash");
    localStorage.removeItem("lspd_history");
    alert("üóë ƒê√£ x√≥a d·ªØ li·ªáu t·∫°m!");
  }
}

/* ‚úÖ Reset to√†n b·ªô h·ªá th·ªëng */
function resetSystem(){
  if(confirm("‚ö†Ô∏è C·∫£nh b√°o: Thao t√°c n√†y s·∫Ω x√≥a T·∫§T C·∫¢ d·ªØ li·ªáu nh√¢n s·ª±, l∆∞∆°ng, c√¥ng... B·∫°n ch·∫Øc ch·∫Øn?")){
    localStorage.clear();
    alert("‚ôªÔ∏è H·ªá th·ªëng ƒë√£ ƒë∆∞·ª£c reset!");
  }
}

/* ‚úÖ B√°o c√°o t·ªïng h·ª£p */
function generateReport(){
  let users = JSON.parse(localStorage.getItem("lspd_users") || "[]");
  let report = `üìä B√°o C√°o T·ªïng H·ª£p\n- T·ªïng s·ªë nh√¢n s·ª±: ${users.length}\n- Ng√†y t·∫°o b√°o c√°o: ${new Date().toLocaleString()}`;
  alert(report);
}

/* ‚úÖ ƒêi·ªÅu h∆∞·ªõng qu·∫£n l√Ω ng∆∞·ªùi d√πng */
function manageUsers(){
  window.location.href = "manage.html";
}
</script>
</body>
</html>
<!DOCTYPE html>